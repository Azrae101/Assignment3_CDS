<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Consumer Persona - The Algorithmic Mirror</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 40px;
            max-width: 600px;
            width: 100%;
            text-align: center;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .tagline {
            color: #666;
            font-size: 14px;
            margin-bottom: 30px;
        }

        h1 {
            color: #333;
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 30px;
        }

        .reveal-text {
            color: #667eea;
            font-size: 18px;
            margin-bottom: 40px;
            font-weight: 600;
        }

        .persona-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: left;
            border-left: 5px solid #667eea;
            transition: transform 0.3s ease;
        }

        .persona-card:hover {
            transform: translateY(-5px);
        }

        .persona-header {
            margin-bottom: 20px;
        }

        .persona-name {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 5px;
        }

        .persona-details {
            color: #666;
            font-size: 14px;
        }

        .persona-description {
            color: #444;
            line-height: 1.6;
            margin-bottom: 20px;
            font-size: 15px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .stat-box {
            background: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid #e9ecef;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .insight-box {
            background: #fff;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #e9ecef;
            margin-bottom: 30px;
        }

        .insight-title {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .insight-stat {
            font-size: 24px;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 10px;
        }

        .insight-text {
            color: #444;
            font-size: 14px;
            line-height: 1.5;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            flex: 1;
            padding: 14px 20px;
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 15px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .btn-secondary:hover {
            background: #f8f9fa;
            transform: translateY(-2px);
        }

        .disclaimer {
            margin-top: 30px;
            padding: 15px;
            background: #fff3cd;
            border-radius: 10px;
            border: 1px solid #ffeaa7;
        }

        .disclaimer p {
            color: #856404;
            font-size: 13px;
            line-height: 1.4;
        }

        @media (max-width: 480px) {
            .container {
                padding: 30px 20px;
            }
            
            h1 {
                font-size: 26px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">ü™û The Algorithmic Mirror</div>
        <p class="tagline">A Critical Data Visualization</p>
        
        <h1>Your Consumer Persona</h1>
        <p class="reveal-text">Based on your input, here's how e-commerce platforms see you:</p>
        
        <div class="persona-card">
            <div class="persona-header">
                <div id="personaName" class="persona-name">The Value-Optimistic Shopper</div>
                <div id="personaDetails" class="persona-details">Age: 25 ‚Ä¢ Female ‚Ä¢ Medium Spender</div>
            </div>
            
            <div id="personaDescription" class="persona-description">
                Based on your demographic profile and spending patterns, you align with one of the key behavioral segments identified in our analysis of 1.25 million e-commerce transactions.
            </div>

            <div class="stats-grid">
                <div class="stat-box">
                    <div id="segmentSize" class="stat-value">211,128</div>
                    <div class="stat-label">People in your segment</div>
                </div>
                <div class="stat-box">
                    <div id="segmentPercentage" class="stat-value">16.8%</div>
                    <div class="stat-label">Of total customers</div>
                </div>
                <div class="stat-box">
                    <div id="pricePerception" class="stat-value">+20.0%</div>
                    <div class="stat-label">Value perception gap</div>
                </div>
                <div class="stat-box">
                    <div id="avgTransaction" class="stat-value">DKK 540</div>
                    <div class="stat-label">Avg. transaction</div>
                </div>
            </div>
        </div>
        
        <div class="insight-box">
            <div class="insight-title">Dataset Insight</div>
            <div id="insightStat" class="insight-stat">1.25 Million</div>
            <div id="insightText" class="insight-text">e-commerce transactions analyzed from the Kaggle dataset. Your persona is based on actual behavioral patterns identified in this data.</div>
        </div>
        
        <div class="button-group">
            <a href="critique.html" class="btn btn-primary">See How This Works</a>
            <a href="index.html" class="btn btn-secondary">Start Over</a>
        </div>
        
        <div class="disclaimer">
            <p>‚ö†Ô∏è <strong>Remember:</strong> This persona is a statistical construct based on limited data points. Real people are more complex than any algorithmic categorization.</p>
        </div>
    </div>

    <script>
        // Behavioral segments with realistic transaction amounts
        const segments = {
            'Value-Optimistic': {
                count: 211128,
                percentage: 16.8,
                description: "You perceive products as 20% more valuable than their actual price, showing strong optimism in your purchasing decisions. This makes you particularly receptive to premium branding and perceived quality enhancements. You're part of the largest customer segment.",
                priceGap: '+20.0%',
                avgTransaction: 67500 // Realistic base value in IDR
            },
            'Value-Realistic': {
                count: 211117,
                percentage: 16.8,
                description: "Your perception of value aligns almost perfectly with actual prices (-0.0% gap), indicating a highly balanced and practical approach to shopping. You're less influenced by marketing tactics and more focused on actual utility.",
                priceGap: '-0.0%',
                avgTransaction: 67500 // Realistic base value in IDR
            },
            'Value-Pessimistic': {
                count: 210799,
                percentage: 16.8,
                description: "You tend to undervalue products by 20% relative to their actual price, approaching purchases with significant caution. This makes you highly price-sensitive and focused on getting the absolute best deal.",
                priceGap: '-20.0%',
                avgTransaction: 60000 // Realistic base value in IDR
            },
            'Premium-Optimistic': {
                count: 184808,
                percentage: 14.7,
                description: "You show strong optimism toward premium products, perceiving them as offering 20% more value than their price. You're heavily influenced by brand reputation and aspirational marketing in luxury categories.",
                priceGap: '+20.0%',
                avgTransaction: 153000 // Realistic base value in IDR
            },
            'Premium-Realistic': {
                count: 185212,
                percentage: 14.8,
                description: "You have a realistic understanding of premium product values, showing no perception gap. You balance quality considerations with price awareness and make deliberate decisions about when premium pricing is justified.",
                priceGap: '0.0%',
                avgTransaction: 153000 // Realistic base value in IDR
            },
            'Premium-Pessimistic': {
                count: 184722,
                percentage: 14.7,
                description: "You're skeptical of premium pricing, often perceiving high-end products as 20% overvalued. You require clear justification for price premiums and are difficult to convince on luxury items.",
                priceGap: '-20.0%',
                avgTransaction: 149000 // Realistic base value in IDR
            },
            'Budget-Optimistic': {
                count: 22178,
                percentage: 1.8,
                description: "Despite budget constraints, you maintain an optimistic view of value, perceiving affordable products as 20% more valuable. You excel at finding hidden gems and believe you're getting great deals.",
                priceGap: '+20.0%',
                avgTransaction: 20000 // Realistic base value in IDR
            },
            'Budget-Realistic': {
                count: 22131,
                percentage: 1.8,
                description: "You have a practical understanding of budget product values with no perception gap. You make careful purchasing decisions within financial constraints while maintaining realistic expectations.",
                priceGap: '0.0%',
                avgTransaction: 19400 // Realistic base value in IDR
            },
            'Budget-Pessimistic': {
                count: 22490,
                percentage: 1.8,
                description: "You approach budget shopping with extreme caution, perceiving even low-priced items as 20% overvalued. You're constantly searching for better value alternatives and rarely impulse buy.",
                priceGap: '-20.0%',
                avgTransaction: 18100 // Realistic base value in IDR
            }
        };

        // Exact demographic patterns from your analysis
        const agePatterns = {
            '18-24': 'Value-Optimistic',
            '25-34': 'Value-Optimistic', 
            '35-44': 'Value-Pessimistic',
            '45-54': 'Value-Optimistic',
            '55-64': 'Value-Realistic',
            '65-74': 'Value-Realistic',
            '75-84': 'Value-Realistic',
            '85+': 'Value-Realistic'
        };

        const genderPatterns = {
            'F': 'Value-Realistic',
            'M': 'Value-Optimistic',
            'not-say': 'Value-Realistic',
            'self-describe': 'Value-Realistic'
        };

        // Updated currency conversion rates based on realistic spending data
        const currencyRates = {
            'INR': { 
                symbol: '‚Çπ', 
                // Base currency (original dataset)
                rate: 1,
                format: (amount) => `‚Çπ${Math.round(amount)}`
            },
            'IDR': { 
                symbol: 'Rp', 
                // Indonesian Rupiah conversion
                rate: 1,
                format: (amount) => `Rp${Math.round(amount).toLocaleString()}`
            },
            'DKK': { 
                symbol: 'DKK', 
                // Realistic conversion (1 IDR ‚âà 0.0043 DKK)
                rate: 0.0043,
                format: (amount) => `DKK ${Math.round(amount * 0.0043)}`
            },
            'USD': { 
                symbol: '$', 
                // Updated based on spending data: 
                // Men: $105 per impulse buy, Women: $71 per impulse buy
                // Average impulse buy: $28.90
                // Budget segments align with average impulse buy
                // Value segments align with gender averages
                // Premium segments align with higher-end impulse purchases
                rate: 0.0009, // Adjusted to match realistic USD amounts
                format: (amount) => `$${Math.round(amount * 0.0009)}`
            },
            'EUR': { 
                symbol: '‚Ç¨', 
                // Realistic conversion (1 IDR ‚âà 0.00083 EUR)
                rate: 0.00083,
                format: (amount) => `‚Ç¨${Math.round(amount * 0.00083)}`
            }
        };

        // Retrieve user data from sessionStorage
        const userData = JSON.parse(sessionStorage.getItem('userData'));
        
        // If no data, redirect to index
        if (!userData) {
            window.location.href = 'index.html';
        }
        
        // Determine age group
        function getAgeGroup(age) {
            if (age <= 24) return '18-24';
            if (age <= 34) return '25-34';
            if (age <= 44) return '35-44';
            if (age <= 54) return '45-54';
            if (age <= 64) return '55-64';
            if (age <= 74) return '65-74';
            if (age <= 84) return '75-84';
            return '85+';
        }

        // Determine behavioral segment based on user data
        function determineSegment(age, gender, spending) {
            const ageGroup = getAgeGroup(parseInt(age));
            const ageBasedSegment = agePatterns[ageGroup];
            const genderBasedSegment = genderPatterns[gender];
            
            // For spending-based adjustment
            let spendingAdjustment = '';
            if (spending === 'low') spendingAdjustment = 'Budget';
            else if (spending === 'medium-low' || spending === 'medium') spendingAdjustment = 'Value';
            else if (spending === 'high') spendingAdjustment = 'Premium';
            
            // Combine factors to determine final segment
            // Priority: Age > Gender > Spending
            let finalSegment = ageBasedSegment;
            
            // If spending strongly contradicts age-based segment, adjust
            if (spendingAdjustment && !finalSegment.includes(spendingAdjustment)) {
                // Find a segment that matches spending category and is close to original
                const possibleSegments = Object.keys(segments).filter(s => 
                    s.includes(spendingAdjustment) && 
                    s.split('-')[1] === finalSegment.split('-')[1]
                );
                
                if (possibleSegments.length > 0) {
                    finalSegment = possibleSegments[0];
                }
            }
            
            return finalSegment;
        }
        
        // Format currency based on selected currency
        function formatCurrency(amount, currency) {
            const currencyInfo = currencyRates[currency];
            if (!currencyInfo) return amount;
            return currencyInfo.format(amount);
        }
        
        // Display the persona
        function displayPersona() {
            const age = parseInt(userData.age);
            const gender = userData.gender;
            const spending = userData.spending;
            const currency = userData.currency || 'DKK';
            
            // Determine the segment
            const segmentName = determineSegment(age, gender, spending);
            const segment = segments[segmentName];
            const ageGroup = getAgeGroup(age);
            
            // Display persona details
            document.getElementById('personaName').textContent = `The ${segmentName} Shopper`;
            
            // Format gender display
            let genderDisplay = gender;
            if (gender === 'female') genderDisplay = 'Female';
            else if (gender === 'male') genderDisplay = 'Male';
            else if (gender === 'not-say') genderDisplay = 'Prefer not to say';
            else if (gender === 'self-describe') genderDisplay = userData.genderDescription || 'Self-described';
            
            // Format spending display
            let spendingDisplay = '';
            switch(spending) {
                case 'low': spendingDisplay = 'Low Spender'; break;
                case 'medium-low': spendingDisplay = 'Medium-Low Spender'; break;
                case 'medium': spendingDisplay = 'Medium Spender'; break;
                case 'high': spendingDisplay = 'High Spender'; break;
            }
            
            document.getElementById('personaDetails').textContent = 
                `Age: ${age} ‚Ä¢ ${genderDisplay} ‚Ä¢ ${spendingDisplay}`;
            
            document.getElementById('personaDescription').textContent = segment.description;
            
            // Update statistics with exact data from your analysis
            document.getElementById('segmentSize').textContent = 
                segment.count.toLocaleString();
            document.getElementById('segmentPercentage').textContent = 
                `${segment.percentage}%`;
            document.getElementById('pricePerception').textContent = 
                segment.priceGap;
            document.getElementById('avgTransaction').textContent = 
                formatCurrency(segment.avgTransaction, currency);
            
            // Update insight with demographic context
            document.getElementById('insightStat').textContent = '1.25 Million';
            document.getElementById('insightText').textContent = 
                `e-commerce transactions analyzed. ${segment.count.toLocaleString()} customers share your ${segmentName} pattern.`;
        }
        
        // Initialize the page
        displayPersona();
    </script>
</body>
</html>